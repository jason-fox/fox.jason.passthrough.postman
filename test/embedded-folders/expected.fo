<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<fo:flow flow-name="xsl-region-body" xmlns:fo="http://www.w3.org/1999/XSL/Format">
  <fo:block>
    <fo:block>
      <fo:block font-weight="bold">Appendix
        <fo:block font-weight="bold">A</fo:block>
      </fo:block>
    </fo:block>
    <fo:block border-after-color="black" font-family="STANDARD" font-weight="bold">FIWARE Persisting Context Data using NIFI</fo:block>
    <fo:table page-break-after="always" table-layout="fixed" width="100%">
      <fo:table-column column-number="1" column-width="35%"></fo:table-column>
      <fo:table-column column-number="2" column-width="65%"></fo:table-column>
      <fo:table-body>
        <fo:table-row>
          <fo:table-cell>
            <fo:block font-family="STANDARD">
              <fo:block font-family="STANDARD" font-weight="bold">Topics:</fo:block>
              <fo:list-block provisional-distance-between-starts="18pt" provisional-label-separation="12pt">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:basic-link color="blue" internal-destination="unique_3">Data Persistence</fo:basic-link>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:basic-link color="blue" internal-destination="unique_5">Architecture</fo:basic-link>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:basic-link color="blue" internal-destination="unique_6">Start Up</fo:basic-link>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:basic-link color="blue" internal-destination="unique_7">Mongo DB - Persisting Context</fo:basic-link>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:basic-link color="blue" internal-destination="unique_10">Mongo DB - Reading Data</fo:basic-link>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:basic-link color="blue" internal-destination="unique_11">PostgreSQL - Persisting Context</fo:basic-link>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:basic-link color="blue" internal-destination="unique_14">PostgreSQL - Reading Data</fo:basic-link>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:basic-link color="blue" internal-destination="unique_15">MySQL - Persisting Context</fo:basic-link>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:basic-link color="blue" internal-destination="unique_18">MySQL - Reading Data</fo:basic-link>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:basic-link color="blue" internal-destination="unique_19">Multi-Agent Persisting to Multiple Databases</fo:basic-link>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
            </fo:block>
          </fo:table-cell>
          <fo:table-cell padding-start="10pt">
            <fo:block></fo:block>
          </fo:table-cell>
        </fo:table-row>
      </fo:table-body>
    </fo:table>
    <fo:block>
      <fo:block>
        <fo:block font-family="STANDARD" font-weight="bold">
          <fo:block>
            <fo:wrapper></fo:wrapper>
            <fo:wrapper></fo:wrapper>Data Persistence</fo:block>
        </fo:block>
        <fo:block>
          <fo:block>"Plots within plots, but all roads lead down the dragon&#8217;s gullet."</fo:block>
          <fo:block>&#8212; George R.R. Martin (A Dance With Dragons)</fo:block>
          <fo:block>Previous tutorials have introduced a set of IoT Sensors (providing measurements of the
state of the real world), and two FIWARE Components - the
            <fo:inline font-weight="bold">Orion Context Broker</fo:inline>and an
            <fo:inline font-weight="bold">IoT Agent</fo:inline>.
This tutorial will introduct a new data persistance component - FIWARE
            <fo:inline font-weight="bold">Draco</fo:inline>.</fo:block>
          <fo:block>The system so far has been built up to handle the current context, in other words it holds the data entities
defining the state of the real-world objects at a given moment in time.</fo:block>
          <fo:block>From this definition you can see - context is only interested in the
            <fo:inline font-weight="bold">current</fo:inline>state of the system
It is not the responsibility of any of the existing components to report on the historical state of the system,
the context is based on the last measurement each sensor has sent data to the context broker.</fo:block>
          <fo:block>In order to do this, we will need to extend the existing architecture to persist changes of state into a database whenever
the context is updated.</fo:block>
          <fo:block>Persisting historical context data is useful for big data analysis - it can be used to discover trends, or data
can be sampled and aggregated to remove the influence of outlying data measurements. However within each Smart Solution,
the significance of each entity type will differ and entities and attributes may need to be sampled at different rates.</fo:block>
          <fo:block>Since the business requirements for using context data differ from application to appliation, there is no one standard use
case for historical data persistence - each situation is unique - it is not the case that one size fits all.
Therefore rather than overloading the context broker with the job of historical context data persistence, this role has been
separated out into a separate, highly configurable component -
            <fo:inline font-weight="bold">Draco</fo:inline>.</fo:block>
          <fo:block>As you would expect,
            <fo:inline font-weight="bold">Draco</fo:inline>, as part of an Open Source platform, is technology agnostic regarding the database
to be used for data persistance. The database you choose to use will depend upon your own business needs.</fo:block>
          <fo:block>However there is a cost to offering this flexibility - each part of the system must be separately configured and
notifications must be set up to only pass the minimal data required as necessary.</fo:block>
        </fo:block>
        <fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">
              <fo:block>
                <fo:wrapper></fo:wrapper>
                <fo:wrapper></fo:wrapper>Device Monitor</fo:block>
            </fo:block>
            <fo:block>
              <fo:block>For the purpose of this tutorial, a series of dummy IoT devices have been created, which will be attached to the context broker.
The state of each device can be seen on the UltraLight device monitor web-page found at:
                <fo:inline font-family="MONOSPACE">http://localhost:3000/device/monitor</fo:inline>
              </fo:block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/device-monitor.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>
                <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 1: FIWARE Monitor</fo:block>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
      </fo:block>
    </fo:block>
    <fo:block>
      <fo:block>
        <fo:block font-family="STANDARD" font-weight="bold">
          <fo:block>
            <fo:wrapper></fo:wrapper>
            <fo:wrapper></fo:wrapper>Architecture</fo:block>
        </fo:block>
        <fo:block>
          <fo:block>This application builds on the components and dummy IoT devices created in
            <fo:basic-link color="blue" external-destination="url('https://github.com/fiware/tutorials.iot-agent/')">previous tutorials</fo:basic-link>. It will make use of three FIWARE components -
the
            <fo:basic-link color="blue" external-destination="url('https://fiware-orion.readthedocs.io/en/latest/')">Orion Context Broker</fo:basic-link>, the
            <fo:basic-link color="blue" external-destination="url('http://fiware-iotagent-ul.readthedocs.io/en/latest/')">IoT Agent for UltraLight 2.0</fo:basic-link>and introduce the
            <fo:basic-link color="blue" external-destination="url('http://fiware-draco.readthedocs.io/en/latest/')">Draco Generic Enabler</fo:basic-link>for persisting context data to a database.
Additional databases are now involved - both the Orion Context Broker and the IoT Agent rely on
            <fo:basic-link color="blue" external-destination="url('https://www.mongodb.com/')">MongoDB</fo:basic-link>technology to keep persistence of the information they hold, and we will be persisting our historical context data another database - either
            <fo:inline font-weight="bold">MySQL</fo:inline>,
            <fo:inline font-weight="bold">PostgreSQL</fo:inline>or
            <fo:inline font-weight="bold">Mongo-DB</fo:inline>database.</fo:block>
          <fo:block>Therefore the overall architecture will consist of the following elements:</fo:block>
          <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>Used by the
                  <fo:inline font-weight="bold">Orion Context Broker</fo:inline>to hold context data information such as data entities, subscriptions and registrations</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>Used by the
                  <fo:inline font-weight="bold">IoT Agent</fo:inline>to hold device information such as device URLs and Keys</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>Potentially used as a data sink to hold historical context data.</fo:block>
              </fo:list-item-body>
            </fo:list-item>
          </fo:list-block>
          <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>Potentially used as a data sink to hold historical context data.</fo:block>
              </fo:list-item-body>
            </fo:list-item>
          </fo:list-block>
          <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>Potentially used as a data sink to hold historical context data.</fo:block>
              </fo:list-item-body>
            </fo:list-item>
          </fo:list-block>
          <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>Display store information and allow users to interact with the dummy IoT devices</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>Show which products can be bought at each store</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>Allow users to "buy" products and reduce the stock count.</fo:block>
              </fo:list-item-body>
            </fo:list-item>
          </fo:list-block>
          <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>receive requests using
                  <fo:basic-link color="blue" external-destination="url('https://fiware.github.io/specifications/openapi/ngsiv2')">NGSI</fo:basic-link>
                </fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>makes requests to publicly available data sources using their own APIs in a proprietory format</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>returns context data back to the Orion Context Broker in
                  <fo:basic-link color="blue" external-destination="url('https://fiware.github.io/specifications/openapi/ngsiv2')">NGSI</fo:basic-link>format.</fo:block>
              </fo:list-item-body>
            </fo:list-item>
          </fo:list-block>
          <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>Three
                  <fo:inline font-weight="bold">FIWARE Generic Enablers</fo:inline>:</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>The FIWARE
                  <fo:basic-link color="blue" external-destination="url('https://fiware-orion.readthedocs.io/en/latest/')">Orion Context Broker</fo:basic-link>which will receive requests using
                  <fo:basic-link color="blue" external-destination="url('https://fiware.github.io/specifications/openapi/ngsiv2')">NGSI</fo:basic-link>
                </fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>The FIWARE
                  <fo:basic-link color="blue" external-destination="url('http://fiware-iotagent-ul.readthedocs.io/en/latest/')">IoT Agent for UltraLight 2.0</fo:basic-link>which will receive southbound requests
using
                  <fo:basic-link color="blue" external-destination="url('https://fiware.github.io/specifications/openapi/ngsiv2')">NGSI</fo:basic-link>and convert them to
                  <fo:basic-link color="blue" external-destination="url('http://fiware-iotagent-ul.readthedocs.io/en/latest/usermanual/index.html#user-programmers-manual')">UltraLight 2.0</fo:basic-link>commands for
the devices</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>FIWARE
                  <fo:basic-link color="blue" external-destination="url('http://fiware-draco.readthedocs.io/en/latest/')">Draco</fo:basic-link>which will subscribe to context changes and persist them into a database (
                  <fo:inline font-weight="bold">MySQL</fo:inline>,
                  <fo:inline font-weight="bold">PostgreSQL</fo:inline>or
                  <fo:inline font-weight="bold">Mongo-DB</fo:inline>)</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>One, two or three of the following
                  <fo:inline font-weight="bold">Databases</fo:inline>:</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>The underlying
                  <fo:basic-link color="blue" external-destination="url('https://www.mongodb.com/')">MongoDB</fo:basic-link>database :</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>An additional
                  <fo:basic-link color="blue" external-destination="url('https://www.postgresql.org/')">PostgreSQL</fo:basic-link>database :</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>An additional
                  <fo:basic-link color="blue" external-destination="url('https://www.mysql.com/')">MySQL</fo:basic-link>database :</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>Three
                  <fo:inline font-weight="bold">Context Providers</fo:inline>:</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>The
                  <fo:inline font-weight="bold">Stock Management Frontend</fo:inline>is not used in this tutorial. It does the following:</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>A webserver acting as set of
                  <fo:basic-link color="blue" external-destination="url('https://github.com/fiware/tutorials.iot-sensors')">dummy IoT devices</fo:basic-link>using the
                  <fo:basic-link color="blue" external-destination="url('http://fiware-iotagent-ul.readthedocs.io/en/latest/usermanual/index.html#user-programmers-manual')">UltraLight 2.0</fo:basic-link>protocol running over HTTP.</fo:block>
              </fo:list-item-body>
            </fo:list-item>
            <fo:list-item relative-align="baseline">
              <fo:list-item-label keep-together.within-line="always">
                <fo:block text-align="start">&#8226;</fo:block>
              </fo:list-item-label>
              <fo:list-item-body>
                <fo:block>The
                  <fo:inline font-weight="bold">Context Provider NGSI</fo:inline>proxy is not used in this tutorial. It does the following:</fo:block>
              </fo:list-item-body>
            </fo:list-item>
          </fo:list-block>
          <fo:block>Since all interactions between the elements are initiated by HTTP requests, the entities can be containerized and run from exposed ports.</fo:block>
          <fo:block>The specific architecture of each section of the tutorial is discussed below.</fo:block>
        </fo:block>
      </fo:block>
    </fo:block>
    <fo:block>
      <fo:block>
        <fo:block font-family="STANDARD" font-weight="bold">
          <fo:block>
            <fo:wrapper></fo:wrapper>
            <fo:wrapper></fo:wrapper>Start Up</fo:block>
        </fo:block>
        <fo:block>
          <fo:block>Before you start you should ensure that you have obtained or built the necessary Docker images locally. Please run</fo:block>
          <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">./services create</fo:block>
          <fo:block>
            <fo:inline font-weight="bold">Note</fo:inline>The
            <fo:inline font-family="MONOSPACE">context-provider</fo:inline>image has not yet been pushed to Docker hub.
Failing to build the Docker sources before proceeding will result in the following error:</fo:block>
          <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">Pulling context-provider (fiware/cp-web-app:latest)...
ERROR: The image for the service you're trying to recreate has been removed.</fo:block>
          <fo:block>Thereafter, all services can be initialised from the command line by running the
            <fo:basic-link color="blue" external-destination="url('https://github.com/fiware/tutorials.historic-context/blob/master/services')">services</fo:basic-link>Bash script provided within the repository:</fo:block>
          <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">./services
            <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">&lt;</fo:inline>command
            <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">&gt;</fo:inline>
          </fo:block>
          <fo:block>Where
            <fo:inline font-family="MONOSPACE">&lt;command&gt;</fo:inline>will vary depending upon the databases we wish to activate.
This command will also import seed data from the previous tutorials and provision the dummy IoT sensors on startup.</fo:block>
          <fo:block>:information_source:
            <fo:inline font-weight="bold">Note:</fo:inline>If you want to clean up and start over again you can do so with the following command:</fo:block>
          <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">./services stop</fo:block>
        </fo:block>
      </fo:block>
    </fo:block>
    <fo:block>
      <fo:block>
        <fo:block font-family="STANDARD" font-weight="bold">
          <fo:block>
            <fo:wrapper></fo:wrapper>
            <fo:wrapper></fo:wrapper>Mongo DB - Persisting Context</fo:block>
        </fo:block>
        <fo:block>
          <fo:block>Persisting historic context data using MongoDB technology is relatively simple to configure since we are already using a
MongoDB instance to hold data related to the Orion Context Broker and the IoT Agent. The MongoDB instance is listening
on the standard
            <fo:inline font-family="MONOSPACE">27017</fo:inline>port and the overall architecture can be seen below:</fo:block>
          <fo:block>
            <fo:inline>
              <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/mongo-draco-tutorial.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
            </fo:inline>
            <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 2:</fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">MongoDB - Database Server Configuration</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">mongo-db</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">image</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>mongo
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">3.6</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">hostname</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>mongo
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>db
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">container_name</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>db
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>mongo
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">ports</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"27017:27017"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">networks</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>default
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">command</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>bind_ip_all
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>smallfiles</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">MongoDB - Draco Configuration</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">draco</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">image</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>ging/fiware
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>draco
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>1.1.0
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">container_name</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>draco
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">depends_on</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>mongo
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>db
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">environment</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>NIFI_WEB_HTTP_PORT=9090
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">ports</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"9090:9090"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"5050:5050"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">healthcheck</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">test</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>curl
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>fail
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>s http
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>//localhost
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>9090/nifi
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>api/system
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>diagnostics
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">|</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">|</fo:inline>exit 1</fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">draco</fo:inline>container is listening on two ports:</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The Subscription Port for Draco -
                      <fo:inline font-family="MONOSPACE">5050</fo:inline>is where the service will be listening for notifications from the Orion
context broker</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The Web interface for Draco -
                      <fo:inline font-family="MONOSPACE">9090</fo:inline>is exposed purely for configuring the processors</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">MongoDB - Start up</fo:block>
            <fo:block>
              <fo:block>To start the system with a
                <fo:inline font-weight="bold">MongoDB</fo:inline>database only, run the following command:</fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">./services mongodb</fo:block>
              <fo:block>Then go to your browser and open Draco using this URL
                <fo:inline font-family="MONOSPACE">http://localhost:9090/nifi</fo:inline>
              </fo:block>
              <fo:block>Now go to the Components toolbar which is placed in the upper section of the NiFi GUI, find the template icon and drag
and drop it inside the Draco user space. At this point, a popup should be displayed with a list of all the templates
available. Please select the template MONGO-TUTORIAL.</fo:block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/mongo-tutorial-template.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>
                <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 3:</fo:block>
              </fo:block>
              <fo:block>Select all the processors (press shift and click on every processor) and start them by clicking on the start button.
Now, you can see that the status icon of each processor turned from red to green.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Generating Context Data</fo:block>
            <fo:block>
              <fo:block>For the purpose of this tutorial, we must be monitoring a system where the context is periodically being updated.
The dummy IoT Sensors can be used to do this. Open the device monitor page at
                <fo:inline font-family="MONOSPACE">http://localhost:3000/device/monitor</fo:inline>and unlock a
                <fo:inline font-weight="bold">Smart Door</fo:inline>and switch on a
                <fo:inline font-weight="bold">Smart Lamp</fo:inline>. This can be done by selecting an appropriate the command
from the drop down list and pressing the
                <fo:inline font-family="MONOSPACE">send</fo:inline>button. The stream of measurements coming from the devices can then
be seen on the same page:</fo:block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context/img/door-open.gif')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>## Draco - Check System Health { .swagger-GET}</fo:block>
              <fo:block background-color="ALICEBLUE" border-color="CORNFLOWERBLUE" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="CORNFLOWERBLUE" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">GET</fo:inline>
                <fo:inline padding-start="10pt">http://{{draco}}/nifi-api/system-diagnostics</fo:inline>
              </fo:block>
              <fo:block>Once Draco is running, you can check the status by making an HTTP request to the exposed draco port to
                <fo:inline font-family="MONOSPACE">/nifi-api/system-diagnostics</fo:inline>. If the response is blank, this is usually because Draco is not running or is listening on another port.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap"></fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X  -G GET
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{draco}}/nifi-api/system-diagnostics'</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">''</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
        <fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">
              <fo:block>
                <fo:wrapper></fo:wrapper>
                <fo:wrapper></fo:wrapper>Orion - Subscribe to Context Changes</fo:block>
            </fo:block>
            <fo:block>
              <fo:block background-color="BEIGE" border-color="#49cc90" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="#49cc90" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">POST</fo:inline>
                <fo:inline padding-start="10pt">http://{{orion}}/v2/subscriptions/</fo:inline>
              </fo:block>
              <fo:block>Once a dynamic context system is up and running, we need to inform
                <fo:inline font-weight="bold">Draco</fo:inline>of changes in context.</fo:block>
              <fo:block>This is done by making a POST request to the
                <fo:inline font-family="MONOSPACE">/v2/subscription</fo:inline>endpoint of the Orion Context Broker.</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>and
                      <fo:inline font-family="MONOSPACE">fiware-servicepath</fo:inline>headers are used to filter the subscription to only listen to measurements from the attached IoT Sensors</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">idPattern</fo:inline>in the request body ensures that Draco will be informed of all context data changes.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The notification
                      <fo:inline font-family="MONOSPACE">url</fo:inline>must match the configured
                      <fo:inline font-family="MONOSPACE">NIFI_WEB_HTTP_PORT</fo:inline>and the URL the sync is listening on (usually
                      <fo:inline font-family="MONOSPACE">/v2/notify</fo:inline>)</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">throttling</fo:inline>value defines the rate that changes are sampled.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
              <fo:block>As you can see, the database used to persist context data has no impact on the details of the subscription. It is the same for each database.</fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Headers</fo:block>
                <fo:block>
                  <fo:block-container reference-orientation="0">
                    <fo:block>
                      <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                        <fo:table-column column-number="1"></fo:table-column>
                        <fo:table-column column-number="2"></fo:table-column>
                        <fo:table-column column-number="3"></fo:table-column>
                        <fo:table-header>
                          <fo:table-row>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Key</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Value</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Description</fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-header>
                        <fo:table-body>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">Content-Type</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">application/json</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-service</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">openiot</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-servicepath</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">/</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-body>
                      </fo:table>
                    </fo:block>
                  </fo:block-container>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"description"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"Notify Draco of all context changes"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"subject"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"entities"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">[</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"idPattern"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">".*"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">]</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"notification"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"http"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"url"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"http://draco:5050/v2/notify"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"throttling"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">5</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X POST
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{orion}}/v2/subscriptions/'</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H Content-Type
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>application/json
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-service
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>openiot
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-servicepath
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>/
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'{
  "description": "Notify Draco of all context changes",
  "subject": {
    "entities": [
      {
        "idPattern": ".*"
      }
    ]
  },
  "notification": {
    "http": {
      "url": "http://draco:5050/v2/notify"
    }
  },
  "throttling": 5
}'</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
        <fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">
              <fo:block>
                <fo:wrapper></fo:wrapper>
                <fo:wrapper></fo:wrapper>Orion - Check Subscription is working</fo:block>
            </fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" border-color="CORNFLOWERBLUE" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="CORNFLOWERBLUE" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">GET</fo:inline>
                <fo:inline padding-start="10pt">http://{{orion}}/v2/subscriptions/</fo:inline>
              </fo:block>
              <fo:block>If a subscription has been created, you can check to see if it is firing by making a GET
request to the
                <fo:inline font-family="MONOSPACE">/v2/subscriptions</fo:inline>endpoint.</fo:block>
              <fo:block>Within the
                <fo:inline font-family="MONOSPACE">notification</fo:inline>section of the response, you can see several additional
                <fo:inline font-family="MONOSPACE">attributes</fo:inline>which describe the health of the subscription</fo:block>
              <fo:block>If the criteria of the subscription have been met,
                <fo:inline font-family="MONOSPACE">timesSent</fo:inline>should be greater than
                <fo:inline font-family="MONOSPACE">0</fo:inline>.
A zero value would indicate that the
                <fo:inline font-family="MONOSPACE">subject</fo:inline>of the subscription is incorrect or the subscription
has created with the wrong
                <fo:inline font-family="MONOSPACE">fiware-service-path</fo:inline>or
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>header</fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">lastNotification</fo:inline>should be a recent timestamp - if this is not the case, then the devices
are not regularly sending data. Remember to unlock the
                <fo:inline font-weight="bold">Smart Door</fo:inline>and switch on the
                <fo:inline font-weight="bold">Smart Lamp</fo:inline>
              </fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">lastSuccess</fo:inline>should match the
                <fo:inline font-family="MONOSPACE">lastNotification</fo:inline>date - if this is not the case
then
                <fo:inline font-weight="bold">Draco</fo:inline>is not receiving the subscription properly. Check that the host name
and port are correct.</fo:block>
              <fo:block>Finally, check that the
                <fo:inline font-family="MONOSPACE">status</fo:inline>of the subscription is
                <fo:inline font-family="MONOSPACE">active</fo:inline>- an expired subscription
will not fire.</fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Headers</fo:block>
                <fo:block>
                  <fo:block-container reference-orientation="0">
                    <fo:block>
                      <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                        <fo:table-column column-number="1"></fo:table-column>
                        <fo:table-column column-number="2"></fo:table-column>
                        <fo:table-column column-number="3"></fo:table-column>
                        <fo:table-header>
                          <fo:table-row>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Key</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Value</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Description</fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-header>
                        <fo:table-body>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-service</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">openiot</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-servicepath</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">/</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-body>
                      </fo:table>
                    </fo:block>
                  </fo:block-container>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap"></fo:block>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X  -G GET
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{orion}}/v2/subscriptions/'</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-service
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>openiot
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-servicepath
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>/
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">''</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
      </fo:block>
    </fo:block>
    <fo:block>
      <fo:block>
        <fo:block font-family="STANDARD" font-weight="bold">
          <fo:block>
            <fo:wrapper></fo:wrapper>
            <fo:wrapper></fo:wrapper>Mongo DB - Reading Data</fo:block>
        </fo:block>
        <fo:block>
          <fo:block>To read mongo-db data from the command line, we will need access to the
            <fo:inline font-family="MONOSPACE">mongo</fo:inline>tool run an interactive instance
of the
            <fo:inline font-family="MONOSPACE">mongo</fo:inline>image as shown to obtain a command line prompt:</fo:block>
          <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">docker run -it --network fiware_default  --entrypoint /bin/bash mongo</fo:block>
          <fo:block>You can then log into to the running
            <fo:inline font-family="MONOSPACE">mongo-db</fo:inline>database by using the command line as shown:</fo:block>
          <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">mongo --host mongo-db</fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Show Available Databases on the MongoDB server</fo:block>
            <fo:block>
              <fo:block>To show the list of available databases, run the statement as shown:</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">show dbs</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">admin          0.000GB
iotagentul     0.000GB
local          0.000GB
orion          0.000GB
orion-openiot  0.000GB
sth_openiot    0.000GB</fo:block>
              <fo:block>The result include two databases
                <fo:inline font-family="MONOSPACE">admin</fo:inline>and
                <fo:inline font-family="MONOSPACE">local</fo:inline>which are set up by default by
                <fo:inline font-weight="bold">MongoDB</fo:inline>, along with four databases
created by the FIWARE platform. The Orion Context Broker has created two separate database instance for each
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>- the Store enitities were created without defining a
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>and therefore are held within the
                <fo:inline font-family="MONOSPACE">orion</fo:inline>database,
whereas the IoT device entities were created using the
                <fo:inline font-family="MONOSPACE">openiot</fo:inline>
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>header and are held separately. The IoT Agent was intialized to hold the IoT sensor data in a separate
                <fo:inline font-weight="bold">MongoDB</fo:inline>database called
                <fo:inline font-family="MONOSPACE">iotagentul</fo:inline>.</fo:block>
              <fo:block>As a result of the subscription of Draco to Orion Context Broker, a new database has been created called
                <fo:inline font-family="MONOSPACE">sth_openiot</fo:inline>. The default value for a
                <fo:inline font-weight="bold">Mongo DB</fo:inline>database holding historic context consists of the
                <fo:inline font-family="MONOSPACE">sth_</fo:inline>prefix followed by the
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>header - therefore
                <fo:inline font-family="MONOSPACE">sth_openiot</fo:inline>holds the historic context of the IoT devices.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Read Historical Context from the MongoDB server</fo:block>
            <fo:block></fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">use sth_openiot
show collections</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">switched to db sth_openiot

sth_/_Door:001_Door
sth_/_Door:001_Door.aggr
sth_/_Lamp:001_Lamp
sth_/_Lamp:001_Lamp.aggr
sth_/_Motion:001_Motion
sth_/_Motion:001_Motion.aggr</fo:block>
              <fo:block>Looking within the
                <fo:inline font-family="MONOSPACE">sth_openiot</fo:inline>you will see that a series of tables have been created. The names of each table consist
of the
                <fo:inline font-family="MONOSPACE">sth_</fo:inline>prefix followed by the
                <fo:inline font-family="MONOSPACE">fiware-servicepath</fo:inline>header followed by the entity id. Two table are created for
each entity - the
                <fo:inline font-family="MONOSPACE">.aggr</fo:inline>table holds some aggregated data which will be accessed in a later tutorial. The raw data
can be seen in the tables without the
                <fo:inline font-family="MONOSPACE">.aggr</fo:inline>suffix.</fo:block>
              <fo:block>The historical data can be seen by looking at the data within each table, by default each row will contain the sampled value of a single attribute.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">db["sth_/_Door:001_Door"].find().limit(10)</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">{ "_id" : ObjectId("5b1fa48630c49e0012f7635d"), "recvTime" : ISODate("2018-06-12T10:46:30.897Z"), "attrName" : "TimeInstant", "attrType" : "ISO8601", "attrValue" : "2018-06-12T10:46:30.836Z" }
{ "_id" : ObjectId("5b1fa48630c49e0012f7635e"), "recvTime" : ISODate("2018-06-12T10:46:30.897Z"), "attrName" : "close_status", "attrType" : "commandStatus", "attrValue" : "UNKNOWN" }
{ "_id" : ObjectId("5b1fa48630c49e0012f7635f"), "recvTime" : ISODate("2018-06-12T10:46:30.897Z"), "attrName" : "lock_status", "attrType" : "commandStatus", "attrValue" : "UNKNOWN" }
{ "_id" : ObjectId("5b1fa48630c49e0012f76360"), "recvTime" : ISODate("2018-06-12T10:46:30.897Z"), "attrName" : "open_status", "attrType" : "commandStatus", "attrValue" : "UNKNOWN" }
{ "_id" : ObjectId("5b1fa48630c49e0012f76361"), "recvTime" : ISODate("2018-06-12T10:46:30.836Z"), "attrName" : "refStore", "attrType" : "Relationship", "attrValue" : "Store:001" }
{ "_id" : ObjectId("5b1fa48630c49e0012f76362"), "recvTime" : ISODate("2018-06-12T10:46:30.836Z"), "attrName" : "state", "attrType" : "Text", "attrValue" : "CLOSED" }
{ "_id" : ObjectId("5b1fa48630c49e0012f76363"), "recvTime" : ISODate("2018-06-12T10:45:26.368Z"), "attrName" : "unlock_info", "attrType" : "commandResult", "attrValue" : " unlock OK" }
{ "_id" : ObjectId("5b1fa48630c49e0012f76364"), "recvTime" : ISODate("2018-06-12T10:45:26.368Z"), "attrName" : "unlock_status", "attrType" : "commandStatus", "attrValue" : "OK" }
{ "_id" : ObjectId("5b1fa4c030c49e0012f76385"), "recvTime" : ISODate("2018-06-12T10:47:28.081Z"), "attrName" : "TimeInstant", "attrType" : "ISO8601", "attrValue" : "2018-06-12T10:47:28.038Z" }
{ "_id" : ObjectId("5b1fa4c030c49e0012f76386"), "recvTime" : ISODate("2018-06-12T10:47:28.081Z"), "attrName" : "close_status", "attrType" : "commandStatus", "attrValue" : "UNKNOWN" }</fo:block>
              <fo:block>The usual
                <fo:inline font-weight="bold">Mongo-DB</fo:inline>query syntax can be used to filter appropriate fields and values. For example to read the rate at which the
                <fo:inline font-weight="bold">Motion Sensor</fo:inline>with the
                <fo:inline font-family="MONOSPACE">id=Motion:001_Motion</fo:inline>is accumulating, you would make a query as follows:</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">db["sth_/_Motion:001_Motion"].find({attrName: "count"},{_id: 0, attrType: 0, attrName: 0 } ).limit(10)</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">{ "recvTime" : ISODate("2018-06-12T10:46:18.756Z"), "attrValue" : "8" }
{ "recvTime" : ISODate("2018-06-12T10:46:36.881Z"), "attrValue" : "10" }
{ "recvTime" : ISODate("2018-06-12T10:46:42.947Z"), "attrValue" : "11" }
{ "recvTime" : ISODate("2018-06-12T10:46:54.893Z"), "attrValue" : "13" }
{ "recvTime" : ISODate("2018-06-12T10:47:00.929Z"), "attrValue" : "15" }
{ "recvTime" : ISODate("2018-06-12T10:47:06.954Z"), "attrValue" : "17" }
{ "recvTime" : ISODate("2018-06-12T10:47:15.983Z"), "attrValue" : "19" }
{ "recvTime" : ISODate("2018-06-12T10:47:49.090Z"), "attrValue" : "23" }
{ "recvTime" : ISODate("2018-06-12T10:47:58.112Z"), "attrValue" : "25" }
{ "recvTime" : ISODate("2018-06-12T10:48:28.218Z"), "attrValue" : "29" }</fo:block>
              <fo:block>To leave the MongoDB client and leave interactive mode, run the following:</fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">exit</fo:inline>
              </fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">exit</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
      </fo:block>
    </fo:block>
    <fo:block>
      <fo:block>
        <fo:block font-family="STANDARD" font-weight="bold">
          <fo:block>
            <fo:wrapper></fo:wrapper>
            <fo:wrapper></fo:wrapper>PostgreSQL - Persisting Context</fo:block>
        </fo:block>
        <fo:block>
          <fo:block>To persist historic context data into an alternative database such as
            <fo:inline font-weight="bold">PostgreSQL</fo:inline>, we will need an additional
container which hosts the PostgreSQL server - the default Docker image for this data can be used. The PostgreSQL
instance is listening on the standard
            <fo:inline font-family="MONOSPACE">5432</fo:inline>port and the overall architecture can be seen below:</fo:block>
          <fo:block>
            <fo:inline>
              <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/postgres-draco-tutorial.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
            </fo:inline>
            <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 4:</fo:block>
          </fo:block>
          <fo:block>We now have a system with two databases, since the MongoDB container is still required to hold data related to the Orion
Context Broker and the IoT Agent.</fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">PostgreSQL - Database Server Configuration</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">postgres-db</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">image</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>postgres
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>latest
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">hostname</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>postgres
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>db
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">container_name</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>db
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>postgres
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">expose</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"5432"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">ports</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"5432:5432"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">networks</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>default
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">environment</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"POSTGRES_PASSWORD=password"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"POSTGRES_USER=postgres"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"POSTGRES_DB=postgres"</fo:inline>
              </fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">postgres-db</fo:inline>container is listening on a single port:</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>Port
                      <fo:inline font-family="MONOSPACE">5432</fo:inline>is the default port for a PostgreSQL server. It has been exposed so you can also run the
                      <fo:inline font-family="MONOSPACE">pgAdmin4</fo:inline>tool
to display database data if you wish</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">postgres-db</fo:inline>container is driven by environment variables as shown:</fo:block>
              <fo:block-container reference-orientation="0">
                <fo:block>
                  <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                    <fo:table-column column-number="1"></fo:table-column>
                    <fo:table-column column-number="2"></fo:table-column>
                    <fo:table-column column-number="3"></fo:table-column>
                    <fo:table-header>
                      <fo:table-row>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Key</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Value.</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Description</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                    </fo:table-header>
                    <fo:table-body>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">POSTGRES_PASSWORD</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">
                            <fo:inline font-family="MONOSPACE">password</fo:inline>
                          </fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">Password for the PostgreSQL database user</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">POSTGRES_USER</fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">
                            <fo:inline font-family="MONOSPACE">postgres</fo:inline>
                          </fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">Username for the PostgreSQL database user</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">POSTGRES_DB</fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">
                            <fo:inline font-family="MONOSPACE">postgres</fo:inline>
                          </fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">The name of the PostgreSQL database</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                    </fo:table-body>
                  </fo:table>
                </fo:block>
              </fo:block-container>
              <fo:block>:information_source:
                <fo:inline font-weight="bold">Note:</fo:inline>Passing the Username and Password in plain text environment variables like this is a
security risk. Whereas this is acceptable practice in a tutorial, for a production environment, you can avoid this
risk by applying
                <fo:basic-link color="blue" external-destination="url('https://blog.docker.com/2017/02/docker-secrets-management/')">Docker Secrets</fo:basic-link>
              </fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">PostgreSQL - Draco Configuration</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">draco</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">image</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>ging/fiware
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>draco
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>1.1.0
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">container_name</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>draco
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">depends_on</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>postgres
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>db
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">environment</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>NIFI_WEB_HTTP_PORT=9090
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">ports</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"9090:9090"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"5050:5050"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">healthcheck</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">test</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>curl
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>fail
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>s http
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>//localhost
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>9090/nifi
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>api/system
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>diagnostics
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">|</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">|</fo:inline>exit 1</fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">draco</fo:inline>container is listening on two ports:</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The Subscription Port for Draco -
                      <fo:inline font-family="MONOSPACE">5050</fo:inline>is where the service will be listening for notifications from the Orion
context broker</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The Web interface for Draco -
                      <fo:inline font-family="MONOSPACE">9090</fo:inline>is exposed purely for configuring the processors.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">PostgreSQL - Start up</fo:block>
            <fo:block>
              <fo:block>To start the system with a
                <fo:inline font-weight="bold">PostgreSQL</fo:inline>database run the following command:</fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">./services postgres</fo:block>
              <fo:block>Then go to your browser and open Draco using this URL
                <fo:inline font-family="MONOSPACE">http://localhost:9090/nifi</fo:inline>
              </fo:block>
              <fo:block>Now go to the Components toolbar which is placed in the upper section of the NiFi GUI, find the template icon and drag
and drop it inside the Draco user space. At this point, a popup should be displayed with a list of all the templates
available. Please select the template POSTGRESQL-TUTORIAL.</fo:block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/postgres-tutorial-template.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>
                <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 5:</fo:block>
              </fo:block>
              <fo:block>Before starting the processors, you need to set your PostgreSQL password and enable the DBCConnectionPool controller.
For doing that please follow the instructions:</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">1.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:block>Do right click on any part of the Draco GUI user space, and then click on configure.
                        <fo:inline>
                          <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/step1.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                        </fo:inline>
                      </fo:block>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">2.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:block>Go to the Controller Services Tab, at this point a list of controllers should be displayed, locate the
DBCConnectionPool controller.</fo:block>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">3.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:block>Click on the configuration button of the "DBCPConnectionPool"
                        <fo:inline>
                          <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/step2.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                        </fo:inline>
                      </fo:block>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">4.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:block>Go to the controller Properties tab and put "password" in the password field, then apply the changes.
                        <fo:inline>
                          <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/controller-postgresql.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                        </fo:inline>
                      </fo:block>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">5.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:block>Enable the processor by clicking on the thunder icon and then click on enable, then close the controller
configuration page.</fo:block>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/step4.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>
                <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 6:</fo:block>
              </fo:block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/step5.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>
                <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 7:</fo:block>
              </fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">1.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>Select all the processors (press shift and click on every processor) and start them by clicking on the start button.
Now, you can see that the status icon of each processor turned from red to green.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">PostgreSQL - Start up</fo:block>
            <fo:block>
              <fo:block>To start the system with a
                <fo:inline font-weight="bold">PostgreSQL</fo:inline>database run the following command:</fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">./services postgres</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">PostgreSQL- Database Server Configuration</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">postgres-db</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">image</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>postgres
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>latest
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">hostname</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>postgres
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>db
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">container_name</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>db
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>postgres
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">expose</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"5432"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">ports</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"5432:5432"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">networks</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>default
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">environment</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"POSTGRES_PASSWORD=password"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"POSTGRES_USER=postgres"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"POSTGRES_DB=postgres"</fo:inline>
              </fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">postgres-db</fo:inline>container is listening on a single port:</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>Port
                      <fo:inline font-family="MONOSPACE">5432</fo:inline>is the default port for a PostgreSQL server. It has been exposed so you can also run the
                      <fo:inline font-family="MONOSPACE">pgAdmin4</fo:inline>tool to display database data if you wish</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">postgres-db</fo:inline>container is driven by environment variables as shown:</fo:block>
              <fo:block-container reference-orientation="0">
                <fo:block>
                  <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                    <fo:table-column column-number="1"></fo:table-column>
                    <fo:table-column column-number="2"></fo:table-column>
                    <fo:table-column column-number="3"></fo:table-column>
                    <fo:table-header>
                      <fo:table-row>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Key</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Value.</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Description</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                    </fo:table-header>
                    <fo:table-body>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">POSTGRES_PASSWORD</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">
                            <fo:inline font-family="MONOSPACE">password</fo:inline>
                          </fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">Password for the PostgreSQL database user</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">POSTGRES_USER</fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">
                            <fo:inline font-family="MONOSPACE">postgres</fo:inline>
                          </fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">Username for the PostgreSQL database user</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">POSTGRES_DB</fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">
                            <fo:inline font-family="MONOSPACE">postgres</fo:inline>
                          </fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">The name of the PostgreSQL database</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                    </fo:table-body>
                  </fo:table>
                </fo:block>
              </fo:block-container>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">PostgreSQL - Draco Configuration</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">draco</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">image</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>fiware/draco
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>ngsi
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>latest
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">hostname</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>draco
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">container_name</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>fiware
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>draco
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">networks</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>default
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">depends_on</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>postgres
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>db
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">expose</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"5080"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">ports</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"5050:5050"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"5080:5080"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">environment</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"CYGNUS_POSTGRESQL_HOST=postgres-db"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"CYGNUS_POSTGRESQL_PORT=5432"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"CYGNUS_POSTGRESQL_USER=postgres"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"CYGNUS_POSTGRESQL_PASS=password"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"CYGNUS_LOG_LEVEL=DEBUG"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"CYGNUS_SERVICE_PORT=5050"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"CYGNUS_API_PORT=5080"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"CYGNUS_POSTGRESQL_ENABLE_CACHE=true"</fo:inline>
              </fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">draco</fo:inline>container is listening on two ports:</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The service will be listening on port
                      <fo:inline font-family="MONOSPACE">5050</fo:inline>for notifications from the Orion context broker</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>Port
                      <fo:inline font-family="MONOSPACE">5080</fo:inline>is exposed purely for tutorial access - so that cUrl or Postman can make provisioning commands
without being part of the same network.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Generating Context Data</fo:block>
            <fo:block>
              <fo:block>For the purpose of this tutorial, we must be monitoring a system where the context is periodically being updated.
The dummy IoT Sensors can be used to do this. Open the device monitor page at
                <fo:inline font-family="MONOSPACE">http://localhost:3000/device/monitor</fo:inline>and unlock a
                <fo:inline font-weight="bold">Smart Door</fo:inline>and switch on a
                <fo:inline font-weight="bold">Smart Lamp</fo:inline>. This can be done by selecting an appropriate the command
from the drop down list and pressing the
                <fo:inline font-family="MONOSPACE">send</fo:inline>button. The stream of measurements coming from the devices can then
be seen on the same page:</fo:block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context/img/door-open.gif')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>## Draco - Check System Health { .swagger-GET}</fo:block>
              <fo:block background-color="ALICEBLUE" border-color="CORNFLOWERBLUE" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="CORNFLOWERBLUE" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">GET</fo:inline>
                <fo:inline padding-start="10pt">http://{{draco}}/nifi-api/system-diagnostics</fo:inline>
              </fo:block>
              <fo:block>Once Draco is running, you can check the status by making an HTTP request to the exposed draco port to
                <fo:inline font-family="MONOSPACE">/nifi-api/system-diagnostics</fo:inline>. If the response is blank, this is usually because Draco is not running or is listening on another port.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap"></fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X  -G GET
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{draco}}/nifi-api/system-diagnostics'</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">''</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
        <fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">
              <fo:block>
                <fo:wrapper></fo:wrapper>
                <fo:wrapper></fo:wrapper>Orion - Subscribe to Context Changes</fo:block>
            </fo:block>
            <fo:block>
              <fo:block background-color="BEIGE" border-color="#49cc90" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="#49cc90" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">POST</fo:inline>
                <fo:inline padding-start="10pt">http://{{orion}}/v2/subscriptions/</fo:inline>
              </fo:block>
              <fo:block>Once a dynamic context system is up and running, we need to inform
                <fo:inline font-weight="bold">Draco</fo:inline>of changes in context.</fo:block>
              <fo:block>This is done by making a POST request to the
                <fo:inline font-family="MONOSPACE">/v2/subscription</fo:inline>endpoint of the Orion Context Broker.</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>and
                      <fo:inline font-family="MONOSPACE">fiware-servicepath</fo:inline>headers are used to filter the subscription to only listen to measurements from the attached IoT Sensors</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">idPattern</fo:inline>in the request body ensures that Draco will be informed of all context data changes.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The notification
                      <fo:inline font-family="MONOSPACE">url</fo:inline>must match the configured
                      <fo:inline font-family="MONOSPACE">NIFI_WEB_HTTP_PORT</fo:inline>and the URL the sync is listening on (usually
                      <fo:inline font-family="MONOSPACE">/v2/notify</fo:inline>)</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">throttling</fo:inline>value defines the rate that changes are sampled.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
              <fo:block>As you can see, the database used to persist context data has no impact on the details of the subscription. It is the same for each database.</fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Headers</fo:block>
                <fo:block>
                  <fo:block-container reference-orientation="0">
                    <fo:block>
                      <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                        <fo:table-column column-number="1"></fo:table-column>
                        <fo:table-column column-number="2"></fo:table-column>
                        <fo:table-column column-number="3"></fo:table-column>
                        <fo:table-header>
                          <fo:table-row>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Key</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Value</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Description</fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-header>
                        <fo:table-body>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">Content-Type</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">application/json</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-service</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">openiot</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-servicepath</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">/</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-body>
                      </fo:table>
                    </fo:block>
                  </fo:block-container>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"description"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"Notify Draco of all context changes"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"subject"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"entities"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">[</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"idPattern"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">".*"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">]</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"notification"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"http"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"url"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"http://draco:5050/v2/notify"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"throttling"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">5</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X POST
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{orion}}/v2/subscriptions/'</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H Content-Type
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>application/json
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-service
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>openiot
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-servicepath
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>/
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'{
  "description": "Notify Draco of all context changes",
  "subject": {
    "entities": [
      {
        "idPattern": ".*"
      }
    ]
  },
  "notification": {
    "http": {
      "url": "http://draco:5050/v2/notify"
    }
  },
  "throttling": 5
}'</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
        <fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">
              <fo:block>
                <fo:wrapper></fo:wrapper>
                <fo:wrapper></fo:wrapper>Orion - Check Subscription is working</fo:block>
            </fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" border-color="CORNFLOWERBLUE" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="CORNFLOWERBLUE" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">GET</fo:inline>
                <fo:inline padding-start="10pt">http://{{orion}}/v2/subscriptions/</fo:inline>
              </fo:block>
              <fo:block>If a subscription has been created, you can check to see if it is firing by making a GET
request to the
                <fo:inline font-family="MONOSPACE">/v2/subscriptions</fo:inline>endpoint.</fo:block>
              <fo:block>Within the
                <fo:inline font-family="MONOSPACE">notification</fo:inline>section of the response, you can see several additional
                <fo:inline font-family="MONOSPACE">attributes</fo:inline>which describe the health of the subscription</fo:block>
              <fo:block>If the criteria of the subscription have been met,
                <fo:inline font-family="MONOSPACE">timesSent</fo:inline>should be greater than
                <fo:inline font-family="MONOSPACE">0</fo:inline>.
A zero value would indicate that the
                <fo:inline font-family="MONOSPACE">subject</fo:inline>of the subscription is incorrect or the subscription
has created with the wrong
                <fo:inline font-family="MONOSPACE">fiware-service-path</fo:inline>or
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>header</fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">lastNotification</fo:inline>should be a recent timestamp - if this is not the case, then the devices
are not regularly sending data. Remember to unlock the
                <fo:inline font-weight="bold">Smart Door</fo:inline>and switch on the
                <fo:inline font-weight="bold">Smart Lamp</fo:inline>
              </fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">lastSuccess</fo:inline>should match the
                <fo:inline font-family="MONOSPACE">lastNotification</fo:inline>date - if this is not the case
then
                <fo:inline font-weight="bold">Draco</fo:inline>is not receiving the subscription properly. Check that the host name
and port are correct.</fo:block>
              <fo:block>Finally, check that the
                <fo:inline font-family="MONOSPACE">status</fo:inline>of the subscription is
                <fo:inline font-family="MONOSPACE">active</fo:inline>- an expired subscription
will not fire.</fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Headers</fo:block>
                <fo:block>
                  <fo:block-container reference-orientation="0">
                    <fo:block>
                      <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                        <fo:table-column column-number="1"></fo:table-column>
                        <fo:table-column column-number="2"></fo:table-column>
                        <fo:table-column column-number="3"></fo:table-column>
                        <fo:table-header>
                          <fo:table-row>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Key</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Value</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Description</fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-header>
                        <fo:table-body>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-service</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">openiot</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-servicepath</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">/</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-body>
                      </fo:table>
                    </fo:block>
                  </fo:block-container>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap"></fo:block>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X  -G GET
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{orion}}/v2/subscriptions/'</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-service
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>openiot
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-servicepath
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>/
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">''</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
      </fo:block>
    </fo:block>
    <fo:block>
      <fo:block>
        <fo:block font-family="STANDARD" font-weight="bold">
          <fo:block>
            <fo:wrapper></fo:wrapper>
            <fo:wrapper></fo:wrapper>PostgreSQL - Reading Data</fo:block>
        </fo:block>
        <fo:block>
          <fo:block>To read PostgreSQL data from the command line, we will need access to the
            <fo:inline font-family="MONOSPACE">postgres</fo:inline>client, to do this, run an
interactive instance of the
            <fo:inline font-family="MONOSPACE">postgresql-client</fo:inline>image supplying the connection string as shown to obtain a command
line prompt:</fo:block>
          <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">docker run -it --rm  --network fiware_default jbergknoff/postgresql-client
            <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>postgresql://postgres:password@postgres-db:5432/postgres</fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Show Available Databases on the PostgreSQL server</fo:block>
            <fo:block>
              <fo:block>To show the list of available databases, run the statement as shown:</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">\list</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">Name    |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   
-----------+----------+----------+------------+------------+-----------------------
 postgres  | postgres | UTF8     | en_US.utf8 | en_US.utf8 | 
 template0 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +
           |          |          |            |            | postgres=CTc/postgres
 template1 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +
           |          |          |            |            | postgres=CTc/postgres
(3 rows)</fo:block>
              <fo:block>The result include two template databases
                <fo:inline font-family="MONOSPACE">template0</fo:inline>and
                <fo:inline font-family="MONOSPACE">template1</fo:inline>as well as the
                <fo:inline font-family="MONOSPACE">postgres</fo:inline>database setup when the docker container was started.</fo:block>
              <fo:block>To show the list of available schemas, run the statement as shown:</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">\dn</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">List of schemas
  Name   |  Owner   
---------+----------
 openiot | postgres
 public  | postgres
(2 rows)</fo:block>
              <fo:block>As a result of the subscription of Draco to Orion Context Broker, a new schema has been created called
                <fo:inline font-family="MONOSPACE">openiot</fo:inline>.
The name of the schema matches the
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>header - therefore
                <fo:inline font-family="MONOSPACE">openiot</fo:inline>holds the historic context of the
IoT devices.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Read Historical Context from the PostgreSQL server</fo:block>
            <fo:block>
              <fo:block>Once running a docker container within the network, it is possible to obtain information about the running
database.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">SELECT</fo:inline>table_schema
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>table_name
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">FROM</fo:inline>information_schema
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">.</fo:inline>
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">tables</fo:inline>
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">WHERE</fo:inline>table_schema
                <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">=</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'openiot'</fo:inline>
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">ORDER</fo:inline>
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">BY</fo:inline>table_schema
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>table_name
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">;</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">table_schema |    table_name     
--------------+-------------------
 openiot      | door_001_door
 openiot      | lamp_001_lamp
 openiot      | motion_001_motion
(3 rows)</fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">table_schema</fo:inline>matches the
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>header supplied with the context data:</fo:block>
              <fo:block>To read the data within a table, run a select statement as shown:</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">SELECT</fo:inline>
                <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">*</fo:inline>
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">FROM</fo:inline>openiot
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">.</fo:inline>motion_001_motion
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">limit</fo:inline>
                <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">10</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">;</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">recvtimets   |         recvtime         | fiwareservicepath |  entityid  | entitytype |  attrname   |   attrtype   |        attrvalue         |                                    attrmd                                    
---------------+--------------------------+-------------------+------------+------------+-------------+--------------+--------------------------+------------------------------------------------------------------------------
 1528803005491 | 2018-06-12T11:30:05.491Z | /                 | Motion:001 | Motion     | TimeInstant | ISO8601      | 2018-06-12T11:30:05.423Z | []
 1528803005491 | 2018-06-12T11:30:05.491Z | /                 | Motion:001 | Motion     | count       | Integer      | 7                        | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:30:05.423Z"}]
 1528803005491 | 2018-06-12T11:30:05.491Z | /                 | Motion:001 | Motion     | refStore    | Relationship | Store:001                | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:30:05.423Z"}]
 1528803035501 | 2018-06-12T11:30:35.501Z | /                 | Motion:001 | Motion     | TimeInstant | ISO8601      | 2018-06-12T11:30:35.480Z | []
 1528803035501 | 2018-06-12T11:30:35.501Z | /                 | Motion:001 | Motion     | count       | Integer      | 10                       | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:30:35.480Z"}]
 1528803035501 | 2018-06-12T11:30:35.501Z | /                 | Motion:001 | Motion     | refStore    | Relationship | Store:001                | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:30:35.480Z"}]
 1528803041563 | 2018-06-12T11:30:41.563Z | /                 | Motion:001 | Motion     | TimeInstant | ISO8601      | 2018-06-12T11:30:41.520Z | []
 1528803041563 | 2018-06-12T11:30:41.563Z | /                 | Motion:001 | Motion     | count       | Integer      | 12                       | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:30:41.520Z"}]
 1528803041563 | 2018-06-12T11:30:41.563Z | /                 | Motion:001 | Motion     | refStore    | Relationship | Store:001                | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:30:41.520Z"}]
 1528803047545 | 2018-06-12T11:30:47.545Z | /</fo:block>
              <fo:block>The usual
                <fo:inline font-weight="bold">PostgreSQL</fo:inline>query syntax can be used to filter appropriate fields and values. For example to read the rate at which the
                <fo:inline font-weight="bold">Motion Sensor</fo:inline>with the
                <fo:inline font-family="MONOSPACE">id=Motion:001_Motion</fo:inline>is accumulating, you would make a query as follows:</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">SELECT</fo:inline>recvtime
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>attrvalue
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">FROM</fo:inline>openiot
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">.</fo:inline>motion_001_motion
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">WHERE</fo:inline>attrname
                <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">=</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'count'</fo:inline>
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">limit</fo:inline>
                <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">10</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">;</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">recvtime         | attrvalue 
--------------------------+-----------
 2018-06-12T11:30:05.491Z | 7
 2018-06-12T11:30:35.501Z | 10
 2018-06-12T11:30:41.563Z | 12
 2018-06-12T11:30:47.545Z | 13
 2018-06-12T11:31:02.617Z | 15
 2018-06-12T11:31:32.718Z | 20
 2018-06-12T11:31:38.733Z | 22
 2018-06-12T11:31:50.780Z | 24
 2018-06-12T11:31:56.825Z | 25
 2018-06-12T11:31:59.790Z | 26
(10 rows)</fo:block>
              <fo:block>To leave the Postgres client and leave interactive mode, run the following:</fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>q</fo:block>
              <fo:block>You will then return to the commmand line.</fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
      </fo:block>
    </fo:block>
    <fo:block>
      <fo:block>
        <fo:block font-family="STANDARD" font-weight="bold">
          <fo:block>
            <fo:wrapper></fo:wrapper>
            <fo:wrapper></fo:wrapper>MySQL - Persisting Context</fo:block>
        </fo:block>
        <fo:block>
          <fo:block>Similarly, to persisting historic context data into
            <fo:inline font-weight="bold">MySQL</fo:inline>, we will again need an additional container which hosts
the MySQL server, once again the default Docker image for this data can be used. The MySQL instance is listening on the
standard
            <fo:inline font-family="MONOSPACE">3306</fo:inline>port and the overall architecture can be seen below:</fo:block>
          <fo:block>
            <fo:inline>
              <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/mysql-draco-tutorial.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
            </fo:inline>
            <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 8:</fo:block>
          </fo:block>
          <fo:block>Once again we have a system with two databases, since the MongoDB container is still required to hold data related to
the Orion Context Broker and the IoT Agent.</fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">MySQL - Database Server Configuration</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">mysql-db</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">restart</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>always
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">image</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>mysql
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">5.7</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">hostname</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>mysql
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>db
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">container_name</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>db
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>mysql
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">expose</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"3306"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">ports</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"3306:3306"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">networks</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>default
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">environment</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"MYSQL_ROOT_PASSWORD=123"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"MYSQL_ROOT_HOST=%"</fo:inline>
              </fo:block>
              <fo:block>:information_source:
                <fo:inline font-weight="bold">Note:</fo:inline>Using the default
                <fo:inline font-family="MONOSPACE">root</fo:inline>user and displaying the password in an environment variables
like this is a security risk. Whereas this is acceptable practice in a tutorial, for a production environment, you can
avoid this risk by setting up another user and applying
                <fo:basic-link color="blue" external-destination="url('https://blog.docker.com/2017/02/docker-secrets-management/')">Docker Secrets</fo:basic-link>
              </fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">mysql-db</fo:inline>container is listening on a single port:</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>Port
                      <fo:inline font-family="MONOSPACE">3306</fo:inline>is the default port for a MySQL server. It has been exposed so you can also run other database tools to
display data if you wish</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">mysql-db</fo:inline>container is driven by environment variables as shown:</fo:block>
              <fo:block-container reference-orientation="0">
                <fo:block>
                  <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                    <fo:table-column column-number="1" column-width="8%"></fo:table-column>
                    <fo:table-column column-number="2" column-width="4%"></fo:table-column>
                    <fo:table-column column-number="3" column-width="86%"></fo:table-column>
                    <fo:table-header>
                      <fo:table-row>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Key</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Value.</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Description</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                    </fo:table-header>
                    <fo:table-body>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">MYSQL_ROOT_PASSWORD</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">
                            <fo:inline font-family="MONOSPACE">123</fo:inline>.</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">specifies a password that is set for the MySQL
                            <fo:inline font-family="MONOSPACE">root</fo:inline>account.</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">MYSQL_ROOT_HOST</fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">
                            <fo:inline font-family="MONOSPACE">postgres</fo:inline>
                          </fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="left">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">By default, MySQL creates the
                            <fo:inline font-family="MONOSPACE">root'@'localhost</fo:inline>account. This account can only be connected to from inside the container. Setting this environment variable allows root connections from other hosts</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                    </fo:table-body>
                  </fo:table>
                </fo:block>
              </fo:block-container>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">MySQL - Draco Configuration</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">draco</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">image</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>ging/fiware
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>draco
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>1.1.0
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">container_name</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>draco
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">depends_on</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>mysql
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>db
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">environment</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>NIFI_WEB_HTTP_PORT=9090
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">ports</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"9090:9090"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"5050:5050"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">healthcheck</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">test</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>curl
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>fail
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>s http
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>//localhost
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>9090/nifi
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>api/system
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>diagnostics
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">|</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">|</fo:inline>exit 1</fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">draco</fo:inline>container is listening on two ports:</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The Subscription Port for Draco -
                      <fo:inline font-family="MONOSPACE">5050</fo:inline>is where the service will be listening for notifications from the Orion
context broker</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The Web interface for Draco -
                      <fo:inline font-family="MONOSPACE">9090</fo:inline>is exposed purely for configuring the processors</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">MySQL - Start up</fo:block>
            <fo:block>
              <fo:block>To start the system with a
                <fo:inline font-weight="bold">MySQL</fo:inline>database run the following command:</fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">./services mysql</fo:block>
              <fo:block>Then go to your browser and open Draco using this URL
                <fo:inline font-family="MONOSPACE">http://localhost:9090/nifi</fo:inline>
              </fo:block>
              <fo:block>Now go to the Components toolbar which is placed in the upper section of the NiFi GUI, find the template icon and drag
and drop it inside the Draco user space. At this point, a popup should be displayed with a list of all the templates
available. Please select the template MYSQL-TUTORIAL.</fo:block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/draco-template1.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>
                <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 9:</fo:block>
              </fo:block>
              <fo:block>Before starting the processors, you need to set your MySQL password and enable the DBCConnectionPool controller. For
doing that please follow the instructions:</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">1.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:block>Do right click on any part of the Draco GUI user space, and then click on configure.
                        <fo:inline>
                          <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/step1.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                        </fo:inline>
                      </fo:block>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">2.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:block>Go to the Controller Services Tab, at this point a list of controllers should be displayed, locate the
DBCConnectionPool controller.</fo:block>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">3.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:block>Click on the configuration button of the "DBCPConnectionPool"
                        <fo:inline>
                          <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/step2.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                        </fo:inline>
                      </fo:block>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">4.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:block>Go to the controller Properties tab and put "123" in the password field, then apply the changes.
                        <fo:inline>
                          <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/step3.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                        </fo:inline>
                      </fo:block>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">5.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>
                      <fo:block>Enable the processor by clicking on the thunder icon and then click on enable, then close the controller
configuration page.
                        <fo:inline>
                          <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/step4.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                        </fo:inline>
                      </fo:block>
                    </fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/step5.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>
                <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 10:</fo:block>
              </fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block font-weight="bold" text-align="start">1.</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>Select all the processors (press shift and click on every processor) and start them by clicking on the start button.
Now, you can see that the status icon of each processor turned from red to green.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Generating Context Data</fo:block>
            <fo:block>
              <fo:block>For the purpose of this tutorial, we must be monitoring a system where the context is periodically being updated.
The dummy IoT Sensors can be used to do this. Open the device monitor page at
                <fo:inline font-family="MONOSPACE">http://localhost:3000/device/monitor</fo:inline>and unlock a
                <fo:inline font-weight="bold">Smart Door</fo:inline>and switch on a
                <fo:inline font-weight="bold">Smart Lamp</fo:inline>. This can be done by selecting an appropriate the command
from the drop down list and pressing the
                <fo:inline font-family="MONOSPACE">send</fo:inline>button. The stream of measurements coming from the devices can then
be seen on the same page:</fo:block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context/img/door-open.gif')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>## Draco - Check System Health { .swagger-GET}</fo:block>
              <fo:block background-color="ALICEBLUE" border-color="CORNFLOWERBLUE" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="CORNFLOWERBLUE" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">GET</fo:inline>
                <fo:inline padding-start="10pt">http://{{draco}}/nifi-api/system-diagnostics</fo:inline>
              </fo:block>
              <fo:block>Once Draco is running, you can check the status by making an HTTP request to the exposed draco port to
                <fo:inline font-family="MONOSPACE">/nifi-api/system-diagnostics</fo:inline>. If the response is blank, this is usually because Draco is not running or is listening on another port.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap"></fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X  -G GET
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{draco}}/nifi-api/system-diagnostics'</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">''</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
        <fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">
              <fo:block>
                <fo:wrapper></fo:wrapper>
                <fo:wrapper></fo:wrapper>Orion - Subscribe to Context Changes</fo:block>
            </fo:block>
            <fo:block>
              <fo:block background-color="BEIGE" border-color="#49cc90" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="#49cc90" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">POST</fo:inline>
                <fo:inline padding-start="10pt">http://{{orion}}/v2/subscriptions/</fo:inline>
              </fo:block>
              <fo:block>Once a dynamic context system is up and running, we need to inform
                <fo:inline font-weight="bold">Draco</fo:inline>of changes in context.</fo:block>
              <fo:block>This is done by making a POST request to the
                <fo:inline font-family="MONOSPACE">/v2/subscription</fo:inline>endpoint of the Orion Context Broker.</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>and
                      <fo:inline font-family="MONOSPACE">fiware-servicepath</fo:inline>headers are used to filter the subscription to only listen to measurements from the attached IoT Sensors</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">idPattern</fo:inline>in the request body ensures that Draco will be informed of all context data changes.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The notification
                      <fo:inline font-family="MONOSPACE">url</fo:inline>must match the configured
                      <fo:inline font-family="MONOSPACE">NIFI_WEB_HTTP_PORT</fo:inline>and the URL the sync is listening on (usually
                      <fo:inline font-family="MONOSPACE">/v2/notify</fo:inline>)</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">throttling</fo:inline>value defines the rate that changes are sampled.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
              <fo:block>As you can see, the database used to persist context data has no impact on the details of the subscription. It is the same for each database.</fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Headers</fo:block>
                <fo:block>
                  <fo:block-container reference-orientation="0">
                    <fo:block>
                      <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                        <fo:table-column column-number="1"></fo:table-column>
                        <fo:table-column column-number="2"></fo:table-column>
                        <fo:table-column column-number="3"></fo:table-column>
                        <fo:table-header>
                          <fo:table-row>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Key</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Value</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Description</fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-header>
                        <fo:table-body>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">Content-Type</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">application/json</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-service</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">openiot</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-servicepath</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">/</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-body>
                      </fo:table>
                    </fo:block>
                  </fo:block-container>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"description"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"Notify Draco of all context changes"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"subject"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"entities"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">[</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"idPattern"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">".*"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">]</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"notification"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"http"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"url"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"http://draco:5050/v2/notify"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"throttling"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">5</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X POST
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{orion}}/v2/subscriptions/'</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H Content-Type
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>application/json
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-service
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>openiot
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-servicepath
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>/
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'{
  "description": "Notify Draco of all context changes",
  "subject": {
    "entities": [
      {
        "idPattern": ".*"
      }
    ]
  },
  "notification": {
    "http": {
      "url": "http://draco:5050/v2/notify"
    }
  },
  "throttling": 5
}'</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
        <fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">
              <fo:block>
                <fo:wrapper></fo:wrapper>
                <fo:wrapper></fo:wrapper>Orion - Check Subscription is working</fo:block>
            </fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" border-color="CORNFLOWERBLUE" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="CORNFLOWERBLUE" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">GET</fo:inline>
                <fo:inline padding-start="10pt">http://{{orion}}/v2/subscriptions/</fo:inline>
              </fo:block>
              <fo:block>If a subscription has been created, you can check to see if it is firing by making a GET
request to the
                <fo:inline font-family="MONOSPACE">/v2/subscriptions</fo:inline>endpoint.</fo:block>
              <fo:block>Within the
                <fo:inline font-family="MONOSPACE">notification</fo:inline>section of the response, you can see several additional
                <fo:inline font-family="MONOSPACE">attributes</fo:inline>which describe the health of the subscription</fo:block>
              <fo:block>If the criteria of the subscription have been met,
                <fo:inline font-family="MONOSPACE">timesSent</fo:inline>should be greater than
                <fo:inline font-family="MONOSPACE">0</fo:inline>.
A zero value would indicate that the
                <fo:inline font-family="MONOSPACE">subject</fo:inline>of the subscription is incorrect or the subscription
has created with the wrong
                <fo:inline font-family="MONOSPACE">fiware-service-path</fo:inline>or
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>header</fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">lastNotification</fo:inline>should be a recent timestamp - if this is not the case, then the devices
are not regularly sending data. Remember to unlock the
                <fo:inline font-weight="bold">Smart Door</fo:inline>and switch on the
                <fo:inline font-weight="bold">Smart Lamp</fo:inline>
              </fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">lastSuccess</fo:inline>should match the
                <fo:inline font-family="MONOSPACE">lastNotification</fo:inline>date - if this is not the case
then
                <fo:inline font-weight="bold">Draco</fo:inline>is not receiving the subscription properly. Check that the host name
and port are correct.</fo:block>
              <fo:block>Finally, check that the
                <fo:inline font-family="MONOSPACE">status</fo:inline>of the subscription is
                <fo:inline font-family="MONOSPACE">active</fo:inline>- an expired subscription
will not fire.</fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Headers</fo:block>
                <fo:block>
                  <fo:block-container reference-orientation="0">
                    <fo:block>
                      <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                        <fo:table-column column-number="1"></fo:table-column>
                        <fo:table-column column-number="2"></fo:table-column>
                        <fo:table-column column-number="3"></fo:table-column>
                        <fo:table-header>
                          <fo:table-row>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Key</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Value</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Description</fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-header>
                        <fo:table-body>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-service</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">openiot</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-servicepath</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">/</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-body>
                      </fo:table>
                    </fo:block>
                  </fo:block-container>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap"></fo:block>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X  -G GET
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{orion}}/v2/subscriptions/'</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-service
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>openiot
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-servicepath
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>/
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">''</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
      </fo:block>
    </fo:block>
    <fo:block>
      <fo:block>
        <fo:block font-family="STANDARD" font-weight="bold">
          <fo:block>
            <fo:wrapper></fo:wrapper>
            <fo:wrapper></fo:wrapper>MySQL - Reading Data</fo:block>
        </fo:block>
        <fo:block>
          <fo:block>To read MySQL data from the command line, we will need access to the
            <fo:inline font-family="MONOSPACE">mysql</fo:inline>client, to do this, run an
interactive instance of the
            <fo:inline font-family="MONOSPACE">mysql</fo:inline>image supplying the connection string as shown to obtain a command
line prompt:</fo:block>
          <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">docker
            <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">exec</fo:inline>-it  db-mysql mysql -h mysql-db -P
            <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">3306</fo:inline>-u root -p123</fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Show Available Databases on the MySQL server</fo:block>
            <fo:block>
              <fo:block>To show the list of available databases, run the statement as shown:</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">SHOW</fo:inline>
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">DATABASES</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">;</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| openiot            |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.00 sec)</fo:block>
              <fo:block>To show the list of available schemas, run the statement as shown:</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">SHOW</fo:inline>SCHEMAS
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">;</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| openiot            |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.00 sec)</fo:block>
              <fo:block>As a result of the subscription of Draco to Orion Context Broker, a new schema has been created called
                <fo:inline font-family="MONOSPACE">openiot</fo:inline>.
The name of the schema matches the
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>header - therefore
                <fo:inline font-family="MONOSPACE">openiot</fo:inline>holds the historic context of the
IoT devices.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Read Historical Context from the PostgreSQL server</fo:block>
            <fo:block>
              <fo:block>Once running a docker container within the network, it is possible to obtain information about the running
database.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">SHOW</fo:inline>
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">tables</fo:inline>
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">FROM</fo:inline>openiot
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">;</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">table_schema |    table_name     
--------------+-------------------
 openiot      | door_001_door
 openiot      | lamp_001_lamp
 openiot      | motion_001_motion
(3 rows)</fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">table_schema</fo:inline>matches the
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>header supplied with the context data:</fo:block>
              <fo:block>To read the data within a table, run a select statement as shown:</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">SELECT</fo:inline>
                <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">*</fo:inline>
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">FROM</fo:inline>openiot
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">.</fo:inline>Motion_001_Motion
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">limit</fo:inline>
                <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">10</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">;</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">+---------------+-------------------------+-------------------+------------+------------+-------------+--------------+--------------------------+------------------------------------------------------------------------------+
| recvTimeTs    | recvTime                | fiwareServicePath | entityId   | entityType | attrName    | attrType     | attrValue                | attrMd                                                                       |
+---------------+-------------------------+-------------------+------------+------------+-------------+--------------+--------------------------+------------------------------------------------------------------------------+
| 1528804397955 | 2018-06-12T11:53:17.955 | /                 | Motion:001 | Motion     | TimeInstant | ISO8601      | 2018-06-12T11:53:17.923Z | []                                                                           |
| 1528804397955 | 2018-06-12T11:53:17.955 | /                 | Motion:001 | Motion     | count       | Integer      | 3                        | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:53:17.923Z"}] |
| 1528804397955 | 2018-06-12T11:53:17.955 | /                 | Motion:001 | Motion     | refStore    | Relationship | Store:001                | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:53:17.923Z"}] |
| 1528804403954 | 2018-06-12T11:53:23.954 | /                 | Motion:001 | Motion     | TimeInstant | ISO8601      | 2018-06-12T11:53:23.928Z | []                                                                           |
| 1528804403954 | 2018-06-12T11:53:23.954 | /                 | Motion:001 | Motion     | count       | Integer      | 5                        | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:53:23.928Z"}] |
| 1528804403954 | 2018-06-12T11:53:23.954 | /                 | Motion:001 | Motion     | refStore    | Relationship | Store:001                | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:53:23.928Z"}] |
| 1528804409970 | 2018-06-12T11:53:29.970 | /                 | Motion:001 | Motion     | TimeInstant | ISO8601      | 2018-06-12T11:53:29.948Z | []                                                                           |
| 1528804409970 | 2018-06-12T11:53:29.970 | /                 | Motion:001 | Motion     | count       | Integer      | 7                        | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:53:29.948Z"}] |
| 1528804409970 | 2018-06-12T11:53:29.970 | /                 | Motion:001 | Motion     | refStore    | Relationship | Store:001                | [{"name":"TimeInstant","type":"ISO8601","value":"2018-06-12T11:53:29.948Z"}] |
| 1528804446083 | 2018-06-12T11:54:06.83  | /                 | Motion:001 | Motion     | TimeInstant | ISO8601      | 2018-06-12T11:54:06.062Z | []                                                                           |
+---------------+-------------------------+-------------------+------------+------------+-------------+--------------+--------------------------+------------------------------------------------------------------------------+</fo:block>
              <fo:block>The usual
                <fo:inline font-weight="bold">MySQL</fo:inline>query syntax can be used to filter appropriate fields and values. For example to read the rate at which the
                <fo:inline font-weight="bold">Motion Sensor</fo:inline>with the
                <fo:inline font-family="MONOSPACE">id=Motion:001_Motion</fo:inline>is accumulating, you would make a query as follows:</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Query:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">SELECT</fo:inline>recvtime
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>attrvalue
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">FROM</fo:inline>openiot
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">.</fo:inline>Motion_001_Motion
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">WHERE</fo:inline>attrname
                <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">=</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'count'</fo:inline>
                <fo:inline color="DARKCYAN" font-family="MONOSPACE" font-weight="bold">LIMIT</fo:inline>
                <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">10</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">;</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Result:</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" font-family="MONOSPACE" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">+-------------------------+-----------+
| recvtime                | attrvalue |
+-------------------------+-----------+
| 2018-06-12T11:53:17.955 | 3         |
| 2018-06-12T11:53:23.954 | 5         |
| 2018-06-12T11:53:29.970 | 7         |
| 2018-06-12T11:54:06.83  | 12        |
| 2018-06-12T11:54:12.132 | 13        |
| 2018-06-12T11:54:24.177 | 14        |
| 2018-06-12T11:54:36.196 | 16        |
| 2018-06-12T11:54:42.195 | 18        |
| 2018-06-12T11:55:24.300 | 23        |
| 2018-06-12T11:55:30.350 | 25        |
+-------------------------+-----------+
10 rows in set (0.00 sec)</fo:block>
              <fo:block>To leave the MySQL client and leave interactive mode, run the following:</fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>q</fo:block>
              <fo:block>You will then return to the commmand line.</fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
      </fo:block>
    </fo:block>
    <fo:block>
      <fo:block>
        <fo:block font-family="STANDARD" font-weight="bold">
          <fo:block>
            <fo:wrapper></fo:wrapper>
            <fo:wrapper></fo:wrapper>Multi-Agent Persisting to Multiple Databases</fo:block>
        </fo:block>
        <fo:block>
          <fo:block>It is also possible to configure Draco to populate multiple databases simultaneously. We can combine the architecture
from the three previous examples and configure Draco to store data in multiple sinks.</fo:block>
          <fo:block>
            <fo:inline>
              <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/multiple-draco-tutorial.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
            </fo:inline>
            <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 11:</fo:block>
          </fo:block>
          <fo:block>We now have a system with three databases, PostgreSQL and MySQL for data persistence and MongoDB for both data
persistence and holding data related to the Orion Context Broker and the IoT Agent.</fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Multi-Agent - Draco Configuration for Multiple Databases</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">draco</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">image</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>ging/fiware
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>draco
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>1.1.0
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">container_name</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>draco
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">depends_on</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>mysql
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>db
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>mongo
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>db
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>postgres
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>db
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">environment</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>NIFI_WEB_HTTP_PORT=9090
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">ports</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"9090:9090"</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"5050:5050"</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">healthcheck</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">test</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>curl
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>fail
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>s http
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>//localhost
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">:</fo:inline>9090/nifi
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>api/system
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">-</fo:inline>diagnostics
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">|</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">|</fo:inline>exit 1</fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">draco</fo:inline>container is listening on two ports:</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The Subscription Port for Draco -
                      <fo:inline font-family="MONOSPACE">5050</fo:inline>is where the service will be listening for notifications from the Orion
context broker</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The Web interface for Draco -
                      <fo:inline font-family="MONOSPACE">9090</fo:inline>is exposed purely for configuring the processors</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Multi-Agent - Start up</fo:block>
            <fo:block>
              <fo:block>To start the system with
                <fo:inline font-weight="bold">multiple</fo:inline>databases run the following command:</fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">./services multiple</fo:block>
              <fo:block>Then go to your browser and open Draco using this URL
                <fo:inline font-family="MONOSPACE">http://localhost:9090/nifi</fo:inline>
              </fo:block>
              <fo:block>Now go to the Components toolbar which is placed in the upper section of the NiFi GUI, find the template icon and drag
and drop it inside the Draco user space. At this point, a popup should be displayed with a list of all the templates
available. Please select the template MULTIPLE-SINKS-TUTORIAL.</fo:block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="fig:" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context-NIFI/img/multiple-tutorial-template.png')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>
                <fo:block font-family="STANDARD" font-weight="bold" keep-with-previous.within-page="always">Figure 12:</fo:block>
              </fo:block>
              <fo:block>Now repeat the process for setting the password in the controller "DBCPConnectionPool" each connection MySQL and
PostgreSQL</fo:block>
              <fo:block>Select all the processors (press shift and click on every processor) and start them by clicking on the start button.
Now, you can see that the status icon of each processor turned from red to green.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Generating Context Data</fo:block>
            <fo:block>
              <fo:block>For the purpose of this tutorial, we must be monitoring a system where the context is periodically being updated.
The dummy IoT Sensors can be used to do this. Open the device monitor page at
                <fo:inline font-family="MONOSPACE">http://localhost:3000/device/monitor</fo:inline>and unlock a
                <fo:inline font-weight="bold">Smart Door</fo:inline>and switch on a
                <fo:inline font-weight="bold">Smart Lamp</fo:inline>. This can be done by selecting an appropriate the command
from the drop down list and pressing the
                <fo:inline font-family="MONOSPACE">send</fo:inline>button. The stream of measurements coming from the devices can then
be seen on the same page:</fo:block>
              <fo:block>
                <fo:inline>
                  <fo:external-graphic content-height="scale-to-fit" content-width="scale-to-fit" fox:alt-text="" height="100%" scaling="uniform" src="url('https://fiware.github.io/tutorials.Historic-Context/img/door-open.gif')" width="100%" xmlns:fox="http://xmlgraphics.apache.org/fop/extensions"></fo:external-graphic>
                </fo:inline>## Draco - Obtain version information { .swagger-GET}</fo:block>
              <fo:block background-color="ALICEBLUE" border-color="CORNFLOWERBLUE" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="CORNFLOWERBLUE" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">GET</fo:inline>
                <fo:inline padding-start="10pt">http://{{draco}}/v1/version</fo:inline>
              </fo:block>
              <fo:block>Once Draco is running, You can check the status by making an HTTP request to the exposed
                <fo:inline font-family="MONOSPACE">CYGNUS_API_PORT</fo:inline>port.
If the response is blank, this is usually because Draco is not running or is listening on another port.</fo:block>
              <fo:block>
                <fo:inline font-weight="bold">Troubleshooting:</fo:inline>What if the response is blank ?</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>To check that a docker container is running try</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">docker
                <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">ps</fo:inline>
              </fo:block>
              <fo:block>You should see several containers running. If
                <fo:inline font-family="MONOSPACE">draco</fo:inline>is not running, you can restart the containers as necessary.</fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap"></fo:block>
            </fo:block>
          </fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X  -G GET
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{draco}}/v1/version'</fo:inline>
                <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">''</fo:inline>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
        <fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">
              <fo:block>
                <fo:wrapper></fo:wrapper>
                <fo:wrapper></fo:wrapper>Orion - Subscribe to Context Changes</fo:block>
            </fo:block>
            <fo:block>
              <fo:block background-color="BEIGE" border-color="#49cc90" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="#49cc90" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">POST</fo:inline>
                <fo:inline padding-start="10pt">http://{{orion}}/v2/subscriptions/</fo:inline>
              </fo:block>
              <fo:block>Once a dynamic context system is up and running, we need to inform
                <fo:inline font-weight="bold">Draco</fo:inline>of changes in context.</fo:block>
              <fo:block>This is done by making a POST request to the
                <fo:inline font-family="MONOSPACE">/v2/subscription</fo:inline>endpoint of the Orion Context Broker.</fo:block>
              <fo:list-block provisional-distance-between-starts="5mm" provisional-label-separation="1mm">
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>and
                      <fo:inline font-family="MONOSPACE">fiware-servicepath</fo:inline>headers are used to filter the subscription to only listen to measurements from the attached IoT Sensors</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">idPattern</fo:inline>in the request body ensures that Draco will be informed of all context data changes.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">attrsFormat=legacy</fo:inline>is required since Draco currently only accepts notifications in the older NGSI v1 format.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
                <fo:list-item relative-align="baseline">
                  <fo:list-item-label keep-together.within-line="always">
                    <fo:block text-align="start">&#8226;</fo:block>
                  </fo:list-item-label>
                  <fo:list-item-body>
                    <fo:block>The
                      <fo:inline font-family="MONOSPACE">throttling</fo:inline>value defines the rate that changes are sampled.</fo:block>
                  </fo:list-item-body>
                </fo:list-item>
              </fo:list-block>
              <fo:block>When running in
                <fo:inline font-weight="bold">multi-agent</fo:inline>mode, the notification
                <fo:inline font-family="MONOSPACE">url</fo:inline>for each subscription must match the defaults for the given database.</fo:block>
              <fo:block>The default port mapping can be seen below:</fo:block>
              <fo:block-container reference-orientation="0">
                <fo:block>
                  <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                    <fo:table-column column-number="1"></fo:table-column>
                    <fo:table-column column-number="2"></fo:table-column>
                    <fo:table-header>
                      <fo:table-row>
                        <fo:table-cell border-before-color="black" text-align="right">
                          <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">sink</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="right">
                          <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">port</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                    </fo:table-header>
                    <fo:table-body>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell border-before-color="black" text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">mysql</fo:block>
                        </fo:table-cell>
                        <fo:table-cell border-before-color="black" text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">5050</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">mongo</fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">5051</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">ckan</fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">5052</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">hdfs</fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">5053</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">postgresql</fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">5054</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                      <fo:table-row keep-together.within-page="always">
                        <fo:table-cell text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">cartodb</fo:block>
                        </fo:table-cell>
                        <fo:table-cell text-align="right">
                          <fo:block space-after.conditionality="retain" space-before.conditionality="retain">5055</fo:block>
                        </fo:table-cell>
                      </fo:table-row>
                    </fo:table-body>
                  </fo:table>
                </fo:block>
              </fo:block-container>
              <fo:block>Since this subscription is using port
                <fo:inline font-family="MONOSPACE">5050</fo:inline>the context data will eventually be persisted to the
                <fo:inline font-style="italic">MySQL</fo:inline>database.</fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Headers</fo:block>
                <fo:block>
                  <fo:block-container reference-orientation="0">
                    <fo:block>
                      <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                        <fo:table-column column-number="1"></fo:table-column>
                        <fo:table-column column-number="2"></fo:table-column>
                        <fo:table-column column-number="3"></fo:table-column>
                        <fo:table-header>
                          <fo:table-row>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Key</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Value</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Description</fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-header>
                        <fo:table-body>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">Content-Type</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">application/json</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-service</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">openiot</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-servicepath</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">/</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-body>
                      </fo:table>
                    </fo:block>
                  </fo:block-container>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"description"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"Notify Draco of all context changes for MySQL on port 5050"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"subject"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"entities"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">[</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"idPattern"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">".*"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">]</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"notification"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"http"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">{</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"url"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"http://draco:5050/notify"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"attrsFormat"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">"legacy"</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">,</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">"throttling"</fo:inline>
                    <fo:inline color="SIENNA" font-family="MONOSPACE" font-weight="bold">:</fo:inline>
                    <fo:inline color="#900050" font-family="MONOSPACE" font-weight="bold">5</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">}</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X POST
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{orion}}/v2/subscriptions/'</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H Content-Type
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>application/json
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-service
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>openiot
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-servicepath
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>/
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'{
  "description": "Notify Draco of all context changes for MySQL on port 5050",
  "subject": {
    "entities": [
      {
        "idPattern": ".*"
      }
    ]
  },
  "notification": {
    "http": {
      "url": "http://draco:5050/notify"
    },
    "attrsFormat": "legacy"
  },
  "throttling": 5
}'</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
        <fo:block>
          <fo:block>
            <fo:block font-family="STANDARD" font-weight="bold">
              <fo:block>
                <fo:wrapper></fo:wrapper>
                <fo:wrapper></fo:wrapper>Orion - Check Subscription is working</fo:block>
            </fo:block>
            <fo:block>
              <fo:block background-color="ALICEBLUE" border-color="CORNFLOWERBLUE" border-style="solid" border-width="1pt" font-family="MONOSPACE" font-weight="bold" padding-start="10pt">
                <fo:inline background-color="CORNFLOWERBLUE" color="white" font-family="STANDARD" padding-end="8pt" padding-start="8pt">GET</fo:inline>
                <fo:inline padding-start="10pt">http://{{orion}}/v2/subscriptions/</fo:inline>
              </fo:block>
              <fo:block>If a subscription has been created, you can check to see if it is firing by making a GET
request to the
                <fo:inline font-family="MONOSPACE">/v2/subscriptions</fo:inline>endpoint.</fo:block>
              <fo:block>Within the
                <fo:inline font-family="MONOSPACE">notification</fo:inline>section of the response, you can see several additional
                <fo:inline font-family="MONOSPACE">attributes</fo:inline>which describe the health of the subscription</fo:block>
              <fo:block>If the criteria of the subscription have been met,
                <fo:inline font-family="MONOSPACE">timesSent</fo:inline>should be greater than
                <fo:inline font-family="MONOSPACE">0</fo:inline>.
A zero value would indicate that the
                <fo:inline font-family="MONOSPACE">subject</fo:inline>of the subscription is incorrect or the subscription
has created with the wrong
                <fo:inline font-family="MONOSPACE">fiware-service-path</fo:inline>or
                <fo:inline font-family="MONOSPACE">fiware-service</fo:inline>header</fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">lastNotification</fo:inline>should be a recent timestamp - if this is not the case, then the devices
are not regularly sending data. Remember to unlock the
                <fo:inline font-weight="bold">Smart Door</fo:inline>and switch on the
                <fo:inline font-weight="bold">Smart Lamp</fo:inline>
              </fo:block>
              <fo:block>The
                <fo:inline font-family="MONOSPACE">lastSuccess</fo:inline>should match the
                <fo:inline font-family="MONOSPACE">lastNotification</fo:inline>date - if this is not the case
then
                <fo:inline font-weight="bold">Draco</fo:inline>is not receiving the subscription properly. Check that the host name
and port are correct.</fo:block>
              <fo:block>Finally, check that the
                <fo:inline font-family="MONOSPACE">status</fo:inline>of the subscription is
                <fo:inline font-family="MONOSPACE">active</fo:inline>- an expired subscription
will not fire.</fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Headers</fo:block>
                <fo:block>
                  <fo:block-container reference-orientation="0">
                    <fo:block>
                      <fo:table border-after-color="black" border-before-color="black" border-end-color="black" border-end-style="solid" border-end-width="1pt" table-layout="fixed" width="100%">
                        <fo:table-column column-number="1"></fo:table-column>
                        <fo:table-column column-number="2"></fo:table-column>
                        <fo:table-column column-number="3"></fo:table-column>
                        <fo:table-header>
                          <fo:table-row>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Key</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Value</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block font-weight="bold" space-after.conditionality="retain" space-before.conditionality="retain">Description</fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-header>
                        <fo:table-body>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-service</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">openiot</fo:block>
                            </fo:table-cell>
                            <fo:table-cell border-before-color="black" text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                          <fo:table-row keep-together.within-page="always">
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">fiware-servicepath</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain">/</fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="left">
                              <fo:block space-after.conditionality="retain" space-before.conditionality="retain"></fo:block>
                            </fo:table-cell>
                          </fo:table-row>
                        </fo:table-body>
                      </fo:table>
                    </fo:block>
                  </fo:block-container>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Body</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap"></fo:block>
                </fo:block>
              </fo:block>
              <fo:block>
                <fo:block font-family="STANDARD" font-weight="bold">Example Request</fo:block>
                <fo:block>
                  <fo:block background-color="ALICEBLUE" color="black" font-family="MONOSPACE" font-weight="bold" hyphenation-character="&#9658;" keep-with-previous.within-page="always" linefeed-treatment="preserve" padding="6pt" white-space-collapse="false" white-space-treatment="preserve" wrap-option="wrap">
                    <fo:inline color="INDIANRED" font-family="MONOSPACE" font-weight="bold">curl</fo:inline>-X  -G GET
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">'http://{{orion}}/v2/subscriptions/'</fo:inline>
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-service
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>openiot
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-H fiware-servicepath
                    <fo:inline color="black" font-family="MONOSPACE" font-weight="bold">:</fo:inline>/
                    <fo:inline color="#909090" font-family="MONOSPACE" font-weight="bold">\</fo:inline>-d
                    <fo:inline color="#609000" font-family="MONOSPACE" font-weight="bold">''</fo:inline>
                  </fo:block>
                </fo:block>
              </fo:block>
            </fo:block>
          </fo:block>
        </fo:block>
      </fo:block>
    </fo:block>
  </fo:block>
</fo:flow>

