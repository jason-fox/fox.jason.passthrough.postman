<?xml version="1.0" encoding="UTF-8" standalone="no"?><!--ant-->
<!--
	This file is part of the DITA-OT Postman Plug-in project.
	See the accompanying LICENSE file for applicable licenses.
-->
<antlib xmlns:if="ant:if" xmlns:unless="ant:unless">

	<!--

		Entry point to the JavaScript tidier function which 
		removes HTML anchor tags and adds ids to headers

			@param file	- The Swagger Markdown file to clean up
		
	-->
	<taskdef classname="fox.jason.passthrough.tasks.PostmanToMarkdownTask" name="postman-to-markdown" onerror="ignore"/>

	<!--
			Individual file processing for postman.
			Take an input format run postman against it and convert to DITA

			@param src - The input file to convert to DITA
			@param dest - The output file location
			@param title - The title of the converted file
			@param metadata - The metadata of the converted file
		-->
		<macrodef name="add-postman-file">
			<attribute name="src" />
			<attribute name="dest" />
			<attribute name="title" />
			<attribute name="metadata"/>
			<sequential>
				<echo taskname="postman" level="info" message="Processing @{src}"/>

				<local name="postman.temp.file"/>
				<tempfile deleteonexit="true" destdir="${dita.temp.dir}" 
					property="postman.temp.file" suffix="md"/>
				
				<postman-to-markdown src="@{src}" dest="${postman.temp.file}"/>
				<add-pandoc-file src="${postman.temp.file}" dest="@{dest}" title="@{title}" metadata="@{metadata}"/>
			</sequential>
		</macrodef>

</antlib>